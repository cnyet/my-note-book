# 产品需求文档 (PRD) - Work Agents v1.0

> **版本**: v1.0
> **状态**: 已确认 (Based on QA-03)
> **最后更新**: 2026-02-07

## 1. 项目概述

### 1.1 产品愿景

打造一款仅供个人使用的智能化工作台，旨在记录生活、工作与学习轨迹，展示个人开发作品，并作为AI能力的试验场。通过多智能体协作（Multi-Agent System），规范和优化个人工作流，将被动的重复性工作转化为主动的创造性成果。

### 1.2 核心价值

- **自动化信息获取**：自动聚合全球AI资讯，节省阅读筛选时间。
- **结构化生活记录**：通过表单与AI分析，量化健康与任务管理。
- **智能化复盘反馈**：每日自动复盘，提取偏好，形成正向反馈闭环。
- **技术展示窗口**：集成独立LobeChat与自研Agent，展示全栈开发能力。

### 1.3 用户画像

- **目标用户**：开发者本人。
- **主要场景**：
  - **早晨 (8:00)**：查看自动生成的AI资讯摘要与穿搭建议。
  - **上午/工作时**：在独立LobeChat中进行自由对话；填写Task表单生成今日待办。
  - **生活/间隙**：填写Life表单记录健康数据。
  - **晚间**：查看Task完成情况，点击Review Agent生成今日复盘，更新个人偏好。

---

## 2. 功能需求详解

### 2.1 智能体矩阵 (Agents Matrix)

| 智能体           | 优先级        | 触发方式          | 核心功能                   | 数据源/依赖                               | 输出物                             |
| :--------------- | :------------ | :---------------- | :------------------------- | :---------------------------------------- | :--------------------------------- |
| **News Agent**   | **P0 (核心)** | 定时(8:00) / 手动 | 爬取AI资讯，生成摘要       | Google News, Reddit, arXiv, aibase (备用) | 10条资讯卡片 (标题/摘要/链接/来源) |
| **Task Agent**   | **P0 (核心)** | 手动填写表单      | 生成今日待办事项           | 用户问答表单                              | 待办列表 (可勾选/修改/删除)        |
| **Review Agent** | **P0 (核心)** | 手动触发 (晚间)   | 综合当日数据复盘，提取偏好 | News/Task/Life 的当日数据                 | 复盘报告 + 更新用户偏好标签        |
| **Life Agent**   | P1 (次要)     | 手动填写表单      | 记录健康数据，生成建议     | 用户手动录入 (身高/体重/运动等)           | 饮食/运动建议 + 健康趋势图         |
| **Outfit Agent** | P2 (锦上添花) | 定时(8:00) / 手动 | 推荐穿搭，生成虚拟试穿图   | 天气API + 日程安排 + 绘图API              | 穿搭建议文本 + 生成的图片          |

### 2.2 详细功能规则

#### 2.2.1 News Agent (资讯助理)

- **数据获取**：
  - 每日8:00自动运行爬虫。
  - **主源**：Google Research, MIT Tech Review, Hacker News, Reddit (AI板块), arXiv。
  - **备用源**：`https://www.aibase.com/zh/news/` (当主源反爬无法绕过时使用)。
  - **反爬策略**：遇到Cloudflare等强验证直接跳过该源，不强求。
- **内容处理**：
  - 无需关键词过滤，全量获取后由LLM筛选最有价值的10条。
  - 生成中文标题和简短摘要。
- **数据存储**：
  - 历史资讯保留 **15天**。
  - 支持按日期回溯查看。

#### 2.2.2 Task Agent (任务助理)

- **交互流程**：
  1. 用户点击"生成任务"。
  2. 弹出问答表单（如：今日核心目标？有哪些会议？）。
  3. AI分析表单内容，转化为结构化的 To-Do List。
- **任务管理**：
  - 支持状态流转：未完成 -> 已完成。
  - 当日未完成任务，次日**不自动继承**，仅标记为“昨日未完成”。
  - 支持手动增删改任务项。

#### 2.2.3 Review Agent (复盘助理)

- **输入数据**：
  - 当日News阅读情况（可选）。
  - 当日Task完成率及内容。
  - 当日Life健康数据及建议。
- **输出内容**：
  - **复盘报告**：总结今日成就与不足。
  - **偏好提取**：自动从复盘中提取用户特征（如：工作习惯偏好上午深钻，饮食偏好低糖等），存入`User Profile`。
- **用户干预**：用户可手动修正提取不准确的偏好标签。

#### 2.2.4 Life Agent (生活助理)

- **数据隐私**：
  - 健康指标（身高、体重、睡眠、血压等）必须 **加密存储** (AES/Fernet) 于后端 SQLite 数据库。
  - 前端展示时解密。
- **功能逻辑**：
  - 基于输入数据，调用LLM生成个性化饮食与运动建议。
  - 简单趋势图展示（无需复杂BI报表，MVP阶段）。

#### 2.2.5 Outfit Agent (穿搭助理)

- **资源准备**：
  - **天气**：调用公共免费天气API。
  - **日程**：用户未输入日程时，AI自动假设标准工作日日程。
- **图片生成**：
  - 调用绘图API (Nano Banana 或 智谱)。
  - 生成图片保存至服务器本地 `backend/data/uploads`。
  - MVP阶段若绘图效果不稳定，可仅输出文字建议。

### 2.3 LobeChat 集成

- **集成方式**：**Iframe 嵌入**。
- **独立性**：
  - LobeChat 作为独立容器运行，拥有独立的对话历史（保留15天）。
  - **不**与 5个内部Agent 进行函数调用 (Function Calling) 或数据互通。
- **布局**：在 `Agents` 页面与 5个内部Agent 并列展示（网格布局）。

### 2.4 其他模块

- **Dashboard**：展示当日核心指标（任务完成率、健康评分、最新资讯概览）。
- **Tools/Labs**：静态展示个人工具链接与实验性项目。
- **Blog**：Markdown 文章管理，展示个人技术输处。

---

## 3. 技术架构需求

### 3.1 技术栈 (已确认)

- **前端**：Next.js + TailwindCSS + Shadcn/ui (现代、高颜值设计)。
- **后端**：Python **FastAPI**。
- **数据库**：**SQLite** (单文件，易备份，加密字段支持)。
- **定时任务**：**APScheduler** (进程内调度，轻量级)。
- **部署**：Docker / Docker Compose。

### 3.2 数据与安全

- **健康数据**：字段级加密 (Encrypt at rest)。
- **图片存储**：本地文件系统存储，不依赖云OSS。
- **网络代理**：后端需预留 `HTTP_PROXY` / `HTTPS_PROXY` 配置支持，以便爬虫访问海外源。

### 3.3 性能与可靠性

- **重试机制**：每日8:00定时任务若失败 (API超时/网络波动)，APScheduler 需配置自动重试策略 (如：间隔15分钟重试3次)。
- **降级策略**：News Agent 主源挂掉自动切换备用源；绘图API失败则仅返回文字。

---

## 4. MVP 验收标准

1.  **环境就绪**：Docker 一键启动所有服务 (Frontend, Backend, LobeChat)。
2.  **核心闭环**：
    - 8:00 能看到 News 列表。
    - 能填写 Task 表单并生成列表。
    - 晚上能生成 Review 报告。
3.  **UI/UX**：界面美观，符合《设计规范》，移动端适配良好。
4.  **数据安全**：验证数据库中的健康数据是否为密文。

---

**附录**：

- 详细API设计见后续 `docs/design/api-design.md`
- 数据库Schema见后续 `docs/design/database-schema.md`
